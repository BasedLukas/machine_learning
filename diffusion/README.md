Work in progress.

inspired by https://github.com/cloneofsimo/minDiffusion